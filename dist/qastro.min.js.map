{"version":3,"file":"qastro.min.js","sources":["../src/rules/checkTitle.js","../src/rules/checkImageAlt.js","../src/rules/checkFormLabel.js","../src/rules/checkNoInlineScript.js","../src/rules/checkNoInlineStyle.js","../src/rules/checkFormAutocomplete.js","../src/rules/checkMetaSecurity.js","../src/rules/checkPasswordAutocomplete.js","../src/rules/checkFormMethodPost.js","../src/rules/checkInlineScriptXSS.js","../src/index.js"],"sourcesContent":["// Rule: checkTitle\r\nexport default function checkTitle(report) {\r\n  const title = document.querySelector('title');\r\n  if (!title || !title.textContent.trim()) {\r\n    report({\r\n      rule: 'checkTitle',\r\n      message: 'Halaman tidak memiliki <title> yang jelas.'\r\n    });\r\n  }\r\n}\r\n","// Rule: checkImageAlt\r\nexport default function checkImageAlt(report) {\r\n  const images = document.querySelectorAll('img');\r\n  images.forEach(img => {\r\n    if (!img.hasAttribute('alt') || !img.getAttribute('alt').trim()) {\r\n      report({\r\n        rule: 'checkImageAlt',\r\n        message: 'Gambar tanpa atribut alt ditemukan.',\r\n        element: img\r\n      });\r\n    }\r\n  });\r\n}\r\n","// Rule: checkFormLabel\r\nexport default function checkFormLabel(report) {\r\n  const inputs = document.querySelectorAll('input, select, textarea');\r\n  inputs.forEach(input => {\r\n    if (\r\n      !input.hasAttribute('aria-label') &&\r\n      !input.hasAttribute('aria-labelledby') &&\r\n      !input.id || !document.querySelector(`label[for='${input.id}']`)\r\n    ) {\r\n      report({\r\n        rule: 'checkFormLabel',\r\n        message: 'Form input tanpa label ditemukan.',\r\n        element: input\r\n      });\r\n    }\r\n  });\r\n}\r\n","// Rule: checkNoInlineScript\r\nexport default function checkNoInlineScript(report) {\r\n  const scripts = document.querySelectorAll('script');\r\n  scripts.forEach(script => {\r\n    if (!script.src && script.textContent.trim()) {\r\n      report({\r\n        rule: 'checkNoInlineScript',\r\n        message: 'Inline <script> terdeteksi. Hindari inline script untuk keamanan.' ,\r\n        element: script\r\n      });\r\n    }\r\n  });\r\n}\r\n","// Rule: checkNoInlineStyle\r\nexport default function checkNoInlineStyle(report) {\r\n  const elements = document.querySelectorAll('[style]');\r\n  elements.forEach(el => {\r\n    report({\r\n      rule: 'checkNoInlineStyle',\r\n      message: 'Inline style terdeteksi. Hindari penggunaan atribut style langsung.',\r\n      element: el\r\n    });\r\n  });\r\n}\r\n","// Rule: checkFormAutocomplete\r\nexport default function checkFormAutocomplete(report) {\r\n  const forms = document.querySelectorAll('form');\r\n  forms.forEach(form => {\r\n    if (!form.hasAttribute('autocomplete')) {\r\n      report({\r\n        rule: 'checkFormAutocomplete',\r\n        message: 'Form tanpa atribut autocomplete ditemukan.',\r\n        element: form\r\n      });\r\n    }\r\n  });\r\n}\r\n","// Rule: checkMetaSecurity\r\nexport default function checkMetaSecurity(report) {\r\n  const metaCSP = document.querySelector('meta[http-equiv=\"Content-Security-Policy\"]');\r\n  if (!metaCSP) {\r\n    report({\r\n      rule: 'checkMetaSecurity',\r\n      message: 'Meta Content-Security-Policy tidak ditemukan.'\r\n    });\r\n  }\r\n  const metaXFO = document.querySelector('meta[http-equiv=\"X-Frame-Options\"]');\r\n  if (!metaXFO) {\r\n    report({\r\n      rule: 'checkMetaSecurity',\r\n      message: 'Meta X-Frame-Options tidak ditemukan.'\r\n    });\r\n  }\r\n}\r\n","// Rule: checkPasswordAutocomplete\r\nexport default function checkPasswordAutocomplete(report) {\r\n  const pwFields = document.querySelectorAll('input[type=\"password\"]');\r\n  pwFields.forEach(input => {\r\n    const ac = input.getAttribute('autocomplete');\r\n    if (!ac || ac === 'on') {\r\n      report({\r\n        rule: 'checkPasswordAutocomplete',\r\n        message: 'Field password sebaiknya menonaktifkan autofill dengan autocomplete=\"new-password\".',\r\n        element: input\r\n      });\r\n    }\r\n  });\r\n}\r\n","// Rule: checkFormMethodPost\r\nexport default function checkFormMethodPost(report) {\r\n  const forms = document.querySelectorAll('form');\r\n  forms.forEach(form => {\r\n    const method = (form.getAttribute('method') || '').toLowerCase();\r\n    if (method !== 'post') {\r\n      report({\r\n        rule: 'checkFormMethodPost',\r\n        message: '<form> tanpa method POST ditemukan. Hindari GET untuk data sensitif.',\r\n        element: form\r\n      });\r\n    }\r\n  });\r\n}\r\n","// Rule: checkInlineScriptXSS\r\nexport default function checkInlineScriptXSS(report) {\r\n  const metaCSP = document.querySelector('meta[http-equiv=\"Content-Security-Policy\"]');\r\n  if (!metaCSP) {\r\n    const scripts = document.querySelectorAll('script');\r\n    scripts.forEach(script => {\r\n      if (!script.src && script.textContent.match(/[<>&\"']/)) {\r\n        report({\r\n          rule: 'checkInlineScriptXSS',\r\n          message: 'Inline script berpotensi XSS ditemukan dan CSP tidak aktif.',\r\n          element: script\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n","// QAstro.js - Auto-run modular accessibility & security linter\r\n\r\nimport checkTitle from './rules/checkTitle.js';\r\nimport checkImageAlt from './rules/checkImageAlt.js';\r\nimport checkFormLabel from './rules/checkFormLabel.js';\r\n\r\nimport checkNoInlineScript from './rules/checkNoInlineScript.js';\r\nimport checkNoInlineStyle from './rules/checkNoInlineStyle.js';\r\nimport checkFormAutocomplete from './rules/checkFormAutocomplete.js';\r\nimport checkMetaSecurity from './rules/checkMetaSecurity.js';\r\nimport checkPasswordAutocomplete from './rules/checkPasswordAutocomplete.js';\r\nimport checkFormMethodPost from './rules/checkFormMethodPost.js';\r\nimport checkInlineScriptXSS from './rules/checkInlineScriptXSS.js';\r\n\r\nconst defaultRules = [\r\n  checkTitle,\r\n  checkImageAlt,\r\n  checkFormLabel,\r\n  checkNoInlineScript,\r\n  checkNoInlineStyle,\r\n  checkFormAutocomplete,\r\n  checkMetaSecurity,\r\n  checkPasswordAutocomplete,\r\n  checkFormMethodPost,\r\n  checkInlineScriptXSS\r\n];\r\n\r\nfunction report(result) {\r\n  const { rule, message, element } = result;\r\n  if (element) {\r\n    console.warn(`[QAstro] [${rule}] ${message}`, element);\r\n  } else {\r\n    console.warn(`[QAstro] [${rule}] ${message}`);\r\n  }\r\n}\r\n\r\nfunction runQAstro({ rules = defaultRules } = {}) {\r\n  rules.forEach(rule => {\r\n    try {\r\n      rule(report);\r\n    } catch (e) {\r\n      console.error(`[QAstro] Error in rule ${rule.name}:`, e);\r\n    }\r\n  });\r\n}\r\n\r\n// Auto-run on DOMContentLoaded\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', () => runQAstro());\r\n} else {\r\n  runQAstro();\r\n}\r\n\r\n// Export for extension\r\nexport default runQAstro;\r\nexport {\r\n  checkTitle,\r\n  checkImageAlt,\r\n  checkFormLabel,\r\n  checkNoInlineScript,\r\n  checkNoInlineStyle,\r\n  checkFormAutocomplete,\r\n  checkMetaSecurity,\r\n  checkPasswordAutocomplete,\r\n  checkFormMethodPost,\r\n  checkInlineScriptXSS\r\n};\r\n"],"names":[],"mappings":";;;;;;EAAA;EACe,SAAS,UAAU,CAAC,MAAM,EAAE;EAC3C,EAAE,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;EAChD,EAAE,IAAI,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE;EAC3C,IAAI,MAAM,CAAC;EACX,MAAM,IAAI,EAAE,YAAY;EACxB,MAAM,OAAO,EAAE,4CAA4C;EAC3D,KAAK,CAAC,CAAC;EACP,EAAE,CAAC;EACH;;ECTA;EACe,SAAS,aAAa,CAAC,MAAM,EAAE;EAC9C,EAAE,MAAM,MAAM,GAAG,QAAQ,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;EAClD,EAAE,MAAM,CAAC,OAAO,CAAC,GAAG,IAAI;EACxB,IAAI,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,EAAE;EACrE,MAAM,MAAM,CAAC;EACb,QAAQ,IAAI,EAAE,eAAe;EAC7B,QAAQ,OAAO,EAAE,qCAAqC;EACtD,QAAQ,OAAO,EAAE,GAAG;EACpB,OAAO,CAAC,CAAC;EACT,IAAI,CAAC;EACL,EAAE,CAAC,CAAC,CAAC;EACL;;ECZA;EACe,SAAS,cAAc,CAAC,MAAM,EAAE;EAC/C,EAAE,MAAM,MAAM,GAAG,QAAQ,CAAC,gBAAgB,CAAC,yBAAyB,CAAC,CAAC;EACtE,EAAE,MAAM,CAAC,OAAO,CAAC,KAAK,IAAI;EAC1B,IAAI;EACJ,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,YAAY,CAAC;EACvC,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,iBAAiB,CAAC;EAC5C,MAAM,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,WAAW,EAAE,KAAK,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACtE,MAAM;EACN,MAAM,MAAM,CAAC;EACb,QAAQ,IAAI,EAAE,gBAAgB;EAC9B,QAAQ,OAAO,EAAE,mCAAmC;EACpD,QAAQ,OAAO,EAAE,KAAK;EACtB,OAAO,CAAC,CAAC;EACT,IAAI,CAAC;EACL,EAAE,CAAC,CAAC,CAAC;EACL;;EChBA;EACe,SAAS,mBAAmB,CAAC,MAAM,EAAE;EACpD,EAAE,MAAM,OAAO,GAAG,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;EACtD,EAAE,OAAO,CAAC,OAAO,CAAC,MAAM,IAAI;EAC5B,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE;EAClD,MAAM,MAAM,CAAC;EACb,QAAQ,IAAI,EAAE,qBAAqB;EACnC,QAAQ,OAAO,EAAE,mEAAmE;EACpF,QAAQ,OAAO,EAAE,MAAM;EACvB,OAAO,CAAC,CAAC;EACT,IAAI,CAAC;EACL,EAAE,CAAC,CAAC,CAAC;EACL;;ECZA;EACe,SAAS,kBAAkB,CAAC,MAAM,EAAE;EACnD,EAAE,MAAM,QAAQ,GAAG,QAAQ,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;EACxD,EAAE,QAAQ,CAAC,OAAO,CAAC,EAAE,IAAI;EACzB,IAAI,MAAM,CAAC;EACX,MAAM,IAAI,EAAE,oBAAoB;EAChC,MAAM,OAAO,EAAE,qEAAqE;EACpF,MAAM,OAAO,EAAE,EAAE;EACjB,KAAK,CAAC,CAAC;EACP,EAAE,CAAC,CAAC,CAAC;EACL;;ECVA;EACe,SAAS,qBAAqB,CAAC,MAAM,EAAE;EACtD,EAAE,MAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;EAClD,EAAE,KAAK,CAAC,OAAO,CAAC,IAAI,IAAI;EACxB,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,EAAE;EAC5C,MAAM,MAAM,CAAC;EACb,QAAQ,IAAI,EAAE,uBAAuB;EACrC,QAAQ,OAAO,EAAE,4CAA4C;EAC7D,QAAQ,OAAO,EAAE,IAAI;EACrB,OAAO,CAAC,CAAC;EACT,IAAI,CAAC;EACL,EAAE,CAAC,CAAC,CAAC;EACL;;ECZA;EACe,SAAS,iBAAiB,CAAC,MAAM,EAAE;EAClD,EAAE,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,4CAA4C,CAAC,CAAC;EACvF,EAAE,IAAI,CAAC,OAAO,EAAE;EAChB,IAAI,MAAM,CAAC;EACX,MAAM,IAAI,EAAE,mBAAmB;EAC/B,MAAM,OAAO,EAAE,+CAA+C;EAC9D,KAAK,CAAC,CAAC;EACP,EAAE,CAAC;EACH,EAAE,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,oCAAoC,CAAC,CAAC;EAC/E,EAAE,IAAI,CAAC,OAAO,EAAE;EAChB,IAAI,MAAM,CAAC;EACX,MAAM,IAAI,EAAE,mBAAmB;EAC/B,MAAM,OAAO,EAAE,uCAAuC;EACtD,KAAK,CAAC,CAAC;EACP,EAAE,CAAC;EACH;;EChBA;EACe,SAAS,yBAAyB,CAAC,MAAM,EAAE;EAC1D,EAAE,MAAM,QAAQ,GAAG,QAAQ,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,CAAC;EACvE,EAAE,QAAQ,CAAC,OAAO,CAAC,KAAK,IAAI;EAC5B,IAAI,MAAM,EAAE,GAAG,KAAK,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;EAClD,IAAI,IAAI,CAAC,EAAE,IAAI,EAAE,KAAK,IAAI,EAAE;EAC5B,MAAM,MAAM,CAAC;EACb,QAAQ,IAAI,EAAE,2BAA2B;EACzC,QAAQ,OAAO,EAAE,qFAAqF;EACtG,QAAQ,OAAO,EAAE,KAAK;EACtB,OAAO,CAAC,CAAC;EACT,IAAI,CAAC;EACL,EAAE,CAAC,CAAC,CAAC;EACL;;ECbA;EACe,SAAS,mBAAmB,CAAC,MAAM,EAAE;EACpD,EAAE,MAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;EAClD,EAAE,KAAK,CAAC,OAAO,CAAC,IAAI,IAAI;EACxB,IAAI,MAAM,MAAM,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,WAAW,EAAE,CAAC;EACrE,IAAI,IAAI,MAAM,KAAK,MAAM,EAAE;EAC3B,MAAM,MAAM,CAAC;EACb,QAAQ,IAAI,EAAE,qBAAqB;EACnC,QAAQ,OAAO,EAAE,sEAAsE;EACvF,QAAQ,OAAO,EAAE,IAAI;EACrB,OAAO,CAAC,CAAC;EACT,IAAI,CAAC;EACL,EAAE,CAAC,CAAC,CAAC;EACL;;ECbA;EACe,SAAS,oBAAoB,CAAC,MAAM,EAAE;EACrD,EAAE,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,4CAA4C,CAAC,CAAC;EACvF,EAAE,IAAI,CAAC,OAAO,EAAE;EAChB,IAAI,MAAM,OAAO,GAAG,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;EACxD,IAAI,OAAO,CAAC,OAAO,CAAC,MAAM,IAAI;EAC9B,MAAM,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE;EAC9D,QAAQ,MAAM,CAAC;EACf,UAAU,IAAI,EAAE,sBAAsB;EACtC,UAAU,OAAO,EAAE,6DAA6D;EAChF,UAAU,OAAO,EAAE,MAAM;EACzB,SAAS,CAAC,CAAC;EACX,MAAM,CAAC;EACP,IAAI,CAAC,CAAC,CAAC;EACP,EAAE,CAAC;EACH;;ECfA;AACA;AAYA;EACA,MAAM,YAAY,GAAG;EACrB,EAAE,UAAU;EACZ,EAAE,aAAa;EACf,EAAE,cAAc;EAChB,EAAE,mBAAmB;EACrB,EAAE,kBAAkB;EACpB,EAAE,qBAAqB;EACvB,EAAE,iBAAiB;EACnB,EAAE,yBAAyB;EAC3B,EAAE,mBAAmB;EACrB,EAAE,oBAAoB;EACtB,CAAC,CAAC;AACF;EACA,SAAS,MAAM,CAAC,MAAM,EAAE;EACxB,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,MAAM,CAAC;EAC5C,EAAE,IAAI,OAAO,EAAE;EACf,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;EAC3D,EAAE,CAAC,MAAM;EACT,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;EAClD,EAAE,CAAC;EACH,CAAC;AACD;EACA,SAAS,SAAS,CAAC,EAAE,KAAK,GAAG,YAAY,EAAE,GAAG,EAAE,EAAE;EAClD,EAAE,KAAK,CAAC,OAAO,CAAC,IAAI,IAAI;EACxB,IAAI,IAAI;EACR,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC;EACnB,IAAI,CAAC,CAAC,OAAO,CAAC,EAAE;EAChB,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC,uBAAuB,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAC/D,IAAI,CAAC;EACL,EAAE,CAAC,CAAC,CAAC;EACL,CAAC;AACD;EACA;EACA,IAAI,QAAQ,CAAC,UAAU,KAAK,SAAS,EAAE;EACvC,EAAE,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,MAAM,SAAS,EAAE,CAAC,CAAC;EACnE,CAAC,MAAM;EACP,EAAE,SAAS,EAAE,CAAC;EACd;;;;;;;;;;;;;;;;;;;;"}